{"title":"微信小程序之电影周周刊","date":"2019-05-14T11:12:51.000Z","link":"post/firstWachatitem","tags":["wx","实例","微信小程序"],"updated":"2019-05-14T11:22:23.000Z","content":"<h1 id=\"first-Wachat-item\">first_Wachat_item<a href=\"post/firstWachatitem#first-Wachat-item\"></a></h1><blockquote>\n<p>制作的第一个小程序：简单的电影推荐小程序</p>\n</blockquote>\n<h3 id=\"目标实现\">目标实现<a href=\"post/firstWachatitem#目标实现\"></a></h3><ol>\n<li>初始化项目文件</li>\n<li>输出两个页面 关于和电影推荐</li>\n<li>tabBar的实现</li>\n<li>页面跳转的了解</li>\n<li>页面基本布局</li>\n<li>swiper轮播的实现</li>\n<li>点击卡片进入详情页面</li>\n<li>调用豆瓣API对详情页面进行渲染</li>\n<li>头部的内容设置及加载图标</li>\n</ol>\n<h3 id=\"1-初始化项目文件\">1.初始化项目文件<a href=\"post/firstWachatitem#1-初始化项目文件\"></a></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//初始化配置</span><br><span class=\"line\">pages：存放页面使用</span><br><span class=\"line\">\t--about 主页页面文件夹</span><br><span class=\"line\">\t\t--about.js\t\t\t==\t.js</span><br><span class=\"line\">\t\t--about.json\t\t==\t.json</span><br><span class=\"line\">\t\t--about.wxml\t\t==\t.html</span><br><span class=\"line\">\t\t--about.wxss\t\t==\t.css</span><br><span class=\"line\">app.js</span><br><span class=\"line\">app.json</span><br><span class=\"line\">app.wxss</span><br></pre></td></tr></table></figure>\n<p>about.json</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"pages\"</span>:[<span class=\"string\">\"pages/home/home\"</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>App.json</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"pages\"</span>: [</span><br><span class=\"line\">    <span class=\"string\">\"pages/about/about\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"pages/weekly/weekly\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"pages/detail/detail\"</span></span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>About.js</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">page(&#123;</span><br><span class=\"line\">\t....</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>初始化就到这就结束。。。。</p>\n<h3 id=\"2-输出两个页面-关于和电影推荐\">2.输出两个页面 关于和电影推荐<a href=\"post/firstWachatitem#2-输出两个页面-关于和电影推荐\"></a></h3><p>在pages目录下创建两个存放页面的文件夹在文件夹下生成四个和初始化同样的配置</p>\n<h3 id=\"3-tabBar的实现\">3.tabBar的实现<a href=\"post/firstWachatitem#3-tabBar的实现\"></a></h3><p>在app.json中我们添加相关代码更多请看<a href=\"https://developers.weixin.qq.com/miniprogram/dev/framework/ability/custom-tabbar.html?search-key=tabBar\" target=\"_blank\" rel=\"noopener\">文档</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">\"tabBar\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"list\"</span>: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"string\">\"text\"</span>: <span class=\"string\">\"每周推荐\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"pagePath\"</span>: <span class=\"string\">\"pages/weekly/weekly\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"iconPath\"</span>: <span class=\"string\">\"images/icon/week1.png\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"selectedIconPath\"</span>: <span class=\"string\">\"images/icon/week.png\"</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        <span class=\"string\">\"text\"</span>: <span class=\"string\">\"About\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"pagePath\"</span>: <span class=\"string\">\"pages/about/about\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"iconPath\"</span>: <span class=\"string\">\"images/icon/about1.png\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"selectedIconPath\"</span>: <span class=\"string\">\"images/icon/about.png\"</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://developers.weixin.qq.com/s/jiSARvmF7i55\" target=\"_blank\" rel=\"noopener\">点击在开发者工具预览</a></p>\n<h3 id=\"4-页面路径了解\">4.页面路径了解<a href=\"post/firstWachatitem#4-页面路径了解\"></a></h3><p>通过 <code>app.json</code> 的 <code>pages</code> 字段就可以知道你当前小程序的所有页面路径:</p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"pages\"</span>: [<span class=\"string\">\"pages/index/index\"</span>, <span class=\"string\">\"pages/logs/logs\"</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"wx-navigateTo-Object-object\">wx.navigateTo(Object object)<a href=\"post/firstWachatitem#wx-navigateTo-Object-object\"></a></h3><h6 id=\"保留当前页面，跳转到应用内的某个页面。但是不能跳到-tabbar-页面。使用-wx-navigateBack-可以返回到原页面。小程序中页面栈最多十层。\">保留当前页面，跳转到应用内的某个页面。但是不能跳到 tabbar 页面。使用 wx.navigateBack 可以返回到原页面。小程序中页面栈最多十层。<a href=\"post/firstWachatitem#保留当前页面，跳转到应用内的某个页面。但是不能跳到-tabbar-页面。使用-wx-navigateBack-可以返回到原页面。小程序中页面栈最多十层。\"></a></h6><p><a href=\"https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html\" target=\"_blank\" rel=\"noopener\">官方文档</a></p>\n<h3 id=\"5-页面基本布局\">5.页面基本布局<a href=\"post/firstWachatitem#5-页面基本布局\"></a></h3><p>主要使用flex布局来进行动态布局 <a href=\"http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html\" target=\"_blank\" rel=\"noopener\">参考</a></p>\n<h3 id=\"6-swiper轮播的实现\">6.swiper轮播的实现<a href=\"post/firstWachatitem#6-swiper轮播的实现\"></a></h3><p>使用小程序自带组件进行调试 <a href=\"https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html\" target=\"_blank\" rel=\"noopener\">参考</a></p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;swiper&gt;</span><br><span class=\"line\">\t&lt;swiper-item&gt;</span><br><span class=\"line\">\t\t....</span><br><span class=\"line\">\t&lt;<span class=\"regexp\">/swiper-item&gt;</span></span><br><span class=\"line\"><span class=\"regexp\">&lt;/</span>swiper&gt;</span><br></pre></td></tr></table></figure>\n<h3 id=\"7-点击卡片进入详情页面\">7.点击卡片进入详情页面<a href=\"post/firstWachatitem#7-点击卡片进入详情页面\"></a></h3><p>创建对应页面文件，在app.json中配置路由地址在swiper-item上绑定点击事件</p>\n<p>跳转到详情页上头部显示加载动画以及渲染出对应名称</p>\n<h3 id=\"8-调用豆瓣API对详情页面进行渲染\">8.调用豆瓣API对详情页面进行渲染<a href=\"post/firstWachatitem#8-调用豆瓣API对详情页面进行渲染\"></a></h3><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Page(&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 页面的初始数据</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  data: &#123;</span><br><span class=\"line\">    mid:<span class=\"number\">0</span>,</span><br><span class=\"line\">    movie:<span class=\"literal\">null</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 生命周期函数--监听页面加载</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  onLoad: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">options</span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.setData(&#123;</span><br><span class=\"line\">      mid:options.id</span><br><span class=\"line\">    &#125;),</span><br><span class=\"line\">    wx.request(&#123;</span><br><span class=\"line\">      <span class=\"comment\">//动态查找影片地址</span></span><br><span class=\"line\">      <span class=\"comment\">//豆瓣屏蔽了小程序的请求</span></span><br><span class=\"line\">      url: <span class=\"string\">'https://douban.uieee.com/v2/movie/subject/'</span> + options.id,</span><br><span class=\"line\">      method: <span class=\"string\">\"GET\"</span>,</span><br><span class=\"line\">      header:&#123;\t<span class=\"comment\">//转换数据类型</span></span><br><span class=\"line\">        <span class=\"string\">\"content-type\"</span>:<span class=\"string\">\"json\"</span></span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      success:<span class=\"function\">(<span class=\"params\">res</span>)=&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(res.statusCode==<span class=\"number\">200</span>)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.setData(&#123;</span><br><span class=\"line\">            movie:res.data\t<span class=\"comment\">//将请求成功的数据存放在定义好的内容中</span></span><br><span class=\"line\">          &#125;)</span><br><span class=\"line\">         wx.setNavigationBarTitle(&#123; <span class=\"comment\">//设置头部名称</span></span><br><span class=\"line\">           title: res.data.title + <span class=\"string\">\"评分：\"</span> + res.data.rating.average + <span class=\"string\">\"分\"</span>,</span><br><span class=\"line\">         &#125;)</span><br><span class=\"line\">         wx.hideNavigationBarLoading() <span class=\"comment\">//隐藏动画</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;  </span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">    wx.showNavigationBarLoading() <span class=\"comment\">//加载动画</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">   * 用户点击右上角分享</span></span><br><span class=\"line\"><span class=\"comment\">   */</span></span><br><span class=\"line\">  onShareAppMessage: <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>&#123;</span><br><span class=\"line\">      title: <span class=\"string\">'向你推荐'</span> + <span class=\"keyword\">this</span>.data.movie.title</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n","prev":{"title":"HTML规范_整体结构","link":"post/HTML规范整体结构"},"next":{"title":"初入微信小程序","link":"post/初入微信小程序"},"plink":"http://yoursite.com/post/firstWachatitem/","toc":[{"title":"first_Wachat_item","id":"first-Wachat-item","index":"1"}]}